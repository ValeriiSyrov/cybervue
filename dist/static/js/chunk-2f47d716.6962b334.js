(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f47d716"],{4468:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"users-container"},[i("el-header",[i("div",{staticClass:"users-header"},[i("h3",[e._v("Users")]),e._v(" "),i("el-button",{attrs:{type:"danger"},domProps:{textContent:e._s("Add user")},on:{click:e.showModal}})],1)]),e._v(" "),i("el-main",[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.users.docs,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{align:"center",label:"ID",width:"80",type:"index",index:e.indexMethod}}),e._v(" "),i("el-table-column",{attrs:{label:"NICKNAME","min-width":"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t\t\t\t\t"+e._s(t.row.login)+"\n\t\t\t\t\t")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"EMAIL",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t\t\t\t\t"+e._s(t.row.email)+"\n\t\t\t\t\t")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"TEAM",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("ul",e._l(t.row.team,function(t,a){return i("li",{key:a,domProps:{textContent:e._s(t)}})}),0)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"SUBSCRIBE",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("ul",e._l(t.row.subscribe,function(t,a){return i("li",{key:a,domProps:{textContent:e._s(t)}})}),0)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"CALENDAR",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("ul",e._l(t.row.calendar,function(t,a){return i("li",{key:a,domProps:{textContent:e._s(t.event)}})}),0)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"status",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"table-btns-wrapper"},[i("el-button",{attrs:{circle:""},on:{click:function(i){return e.handlerAnalytics(t.row)}}},[i("svg-icon",{attrs:{"icon-class":"analytics"}})],1),e._v(" "),i("el-button",{attrs:{circle:""},on:{click:function(i){return e.showNotifyModal(t.row)}}},[i("svg-icon",{attrs:{"icon-class":"notification"}})],1),e._v(" "),i("el-button",{attrs:{icon:"el-icon-edit-outline",circle:""},on:{click:function(i){return e.showModal(t.row)}}}),e._v(" "),i("el-button",{attrs:{icon:"el-icon-delete",circle:""},on:{click:function(i){return e.handlerDelete(t.row._id)}}})],1)]}}])})],1)],1),e._v(" "),i("el-footer",[i("el-pagination",{attrs:{"current-page":e.pagination_page,layout:"prev, pager, next",total:e.users.totalDocs},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.pagination_page=t},"update:current-page":function(t){e.pagination_page=t}}})],1),e._v(" "),i("el-dialog",{attrs:{title:"Edit user",visible:e.modal,width:"75%","before-close":e.handleClose},on:{"update:visible":function(t){e.modal=t}}},[i("el-form",{ref:"editableUser",attrs:{model:e.editableUser,rules:e.rules,"label-width":"150px"}},[i("el-form-item",{attrs:{label:"Nickname",prop:"login"}},[i("el-input",{attrs:{placeholder:"Enter user nickname"},model:{value:e.editableUser.login,callback:function(t){e.$set(e.editableUser,"login",t)},expression:"editableUser.login"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Password",prop:"password"}},[i("el-input",{attrs:{placeholder:"Password"},model:{value:e.editableUser.password,callback:function(t){e.$set(e.editableUser,"password",t)},expression:"editableUser.password"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Email",prop:"email"}},[i("el-input",{attrs:{placeholder:"Enter email"},model:{value:e.editableUser.email,callback:function(t){e.$set(e.editableUser,"email",t)},expression:"editableUser.email"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Team",prop:"team"}},[i("el-input",{attrs:{placeholder:"User teams"},model:{value:e.editableUser.team,callback:function(t){e.$set(e.editableUser,"team",t)},expression:"editableUser.team"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Calendar",prop:"calendar"}},[i("el-select",{attrs:{multiple:"",placeholder:"Events"},model:{value:e.editableUser.calendar,callback:function(t){e.$set(e.editableUser,"calendar",t)},expression:"editableUser.calendar"}},e._l(e.filteredEvents,function(e){return i("el-option",{key:e._id,attrs:{label:e.event,value:e._id}})}),1)],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.handleClose}},[e._v("Cancel")]),e._v(" "),i("el-button",{attrs:{type:this.editable_user?"success":"warning",plain:""},domProps:{textContent:e._s(this.editable_user?"Update":"Create")},on:{click:e.handleConfirm}})],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"Notify",visible:e.notify_modal,width:"75%","before-close":e.handleCloseNotify},on:{"update:visible":function(t){e.notify_modal=t}}},[i("el-form",{ref:"notifyData",attrs:{model:e.notifyData,rules:e.notifyRules,"label-width":"150px"}},[i("el-form-item",{attrs:{label:"Title",prop:"title"}},[i("el-input",{attrs:{placeholder:"Enter notify title"},model:{value:e.notifyData.title,callback:function(t){e.$set(e.notifyData,"title",t)},expression:"notifyData.title"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Message",prop:"message"}},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:5,maxRows:15},placeholder:"Enter notify message"},model:{value:e.notifyData.message,callback:function(t){e.$set(e.notifyData,"message",t)},expression:"notifyData.message"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.handleCloseNotify}},[e._v("Cancel")]),e._v(" "),i("el-button",{attrs:{type:"success",plain:""},domProps:{textContent:e._s("Send")},on:{click:e.handleConfirmNotify}})],1)],1)],1)},n=[],l=(i("28a5"),i("bd86")),s=(i("ac6a"),i("2f62"),{name:"Users",computed:{users:function(){return this.$store.state.users.users},events:function(){return this.$store.state.home.events},filteredEvents:function(){var e=this,t=this.events.filter(function(t){var i=!0;return e.editableUser.calendar.length&&e.editableUser.calendar.forEach(function(e){e._id!=t._id&&e!=t._id||(i=!1)}),i});return t}},data:function(){var e,t=function(e,t,i){t.trim().length>0?i():i(new Error("Please enter the correct user name"))},i=function(e,t,i){t.trim().length>0?i():i(new Error("Please enter the correct password"))},a=function(e,t,i){t.trim().length>0?i():i(new Error("Please enter the correct email"))},n=function(e,t,i){t.trim().length>0?i():i(new Error("Please enter the correct title"))};return e={loading:!0,pagination_page:1,modal:!1,editable_user:!1,editable_user_id:null,editableUser:{login:"",email:"",team:"",calendar:[],setting:"",password:""},rules:{login:[{required:!0,trigger:"blur",validator:t}],email:[{required:!0,trigger:"blur",validator:a}],password:[{required:!0,trigger:"blur",validator:i}]},notify_modal:!1},Object(l["a"])(e,"editable_user",""),Object(l["a"])(e,"editable_user_id",""),Object(l["a"])(e,"notifyData",{title:"",message:""}),Object(l["a"])(e,"notifyRules",{title:[{required:!0,trigger:"blur",validator:n}]}),e},methods:{indexMethod:function(e){return 10*(this.pagination_page-1)+e+1},handlerAnalytics:function(e){console.log(e)},showNotifyModal:function(e){this.notify_modal=!0,this.editable_user_id=e._id},handleCloseNotify:function(){this.notify_modal=!1,this.editable_user_id="",this.notifyData={title:"",message:""}},handleConfirmNotify:function(){var e=this,t=this.notifyData;t.idUser=this.editable_user_id,this.$refs.notifyData.validate(function(i){i&&e.$store.dispatch("notifications/sendNotification",t).then(function(){e.handleCloseNotify()})})},showModal:function(e){this.modal=!0,e._id&&(this.editable_user=!0,this.editable_user_id=e._id,this.editableUser.login=e.login,this.editableUser.password=e.password,this.editableUser.email=e.email,this.editableUser.team=e.team?e.team.join(", "):"",this.editableUser.calendar=e.calendar)},handleClose:function(){this.modal=!1,this.$refs.editableUser.resetFields(),this.editable_user=!1,this.editable_user_id=null,this.editableUser={login:"",email:"",team:"",calendar:[],setting:"",password:""}},handleConfirm:function(){var e=this;this.$refs.editableUser.validate(function(t){if(!t)return console.error("error submit!!"),!1;var i={};for(var a in e.editableUser)e.editableUser[a]&&(i[a]="subscribe"==a?e.editableUser[a].split(", "):e.editableUser[a]);e.editable_user?e.editUser(i):e.createUser(i)})},editUser:function(e){var t=this;this.$store.dispatch("users/updateUser",[e,this.editable_user_id]).then(function(){t.$store.dispatch("users/getUsers",{limit:10,page:t.pagination_page}).then(function(){t.loading=!1,t.handleClose()})})},createUser:function(e){var t=this;this.loading=!0,this.$store.dispatch("users/createUser",e).then(function(){t.$store.dispatch("users/getUsers",{limit:10,page:t.pagination_page}).then(function(){t.loading=!1,t.handleClose()})})},handlerDelete:function(e){var t=this;this.loading=!0,this.$store.dispatch("users/deleteUser",e).then(function(){t.$store.dispatch("users/getUsers",{limit:10,page:t.pagination_page}).then(function(){t.loading=!1})})},handleCurrentChange:function(e){var t=this;this.loading=!0,this.$store.dispatch("users/getUsers",{limit:10,page:this.pagination_page}).then(function(){t.loading=!1})}},created:function(){var e=this,t={limit:10,page:1};this.$store.dispatch("users/getUsers",t).then(function(){e.loading=!1})},beforeDestroy:function(){this.$store.commit("users/SET_USERS",[])}}),r=s,o=(i("9124"),i("2877")),d=Object(o["a"])(r,a,n,!1,null,"40f60b8c",null);t["default"]=d.exports},9124:function(e,t,i){"use strict";var a=i("cd08"),n=i.n(a);n.a},cd08:function(e,t,i){}}]);